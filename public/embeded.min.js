!function(){const e=window.embeddedChatbotConfig||{},{chatbotId:n,domain:t}=e;if(!n||!t)return void console.error("Chatbot configuration is missing or incomplete");const o=document.createElement("div");o.id="embedded-chatbot-container",document.body.appendChild(o);let r=!1,i=[{role:"assistant",content:"ðŸ‘‹ Hi! How can I help you?"}],s="",d=!1;function l(){const e="w-16 h-16 rounded-full shadow-lg transition-all duration-300 ease-in-out fixed bottom-4 right-4 flex items-center justify-center "+(r?"bg-red-500 hover:bg-red-600":"bg-blue-500 hover:bg-blue-600");o.innerHTML=`\n        <button id="toggle-chat" class="${e}">\n          ${r?'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>':'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg>'}\n        </button>\n        ${r?`\n          <div class="fixed bottom-24 right-4 w-80 bg-white border rounded-lg shadow-lg overflow-hidden">\n            <div class="h-96 p-4 overflow-y-auto">\n              ${i.map(((e,n)=>`\n                <div class="flex ${"user"===e.role?"justify-end":"justify-start"} mb-4">\n                  ${"assistant"===e.role?'\n                    <div class="h-8 w-8 mr-2 rounded-full bg-blue-500 flex items-center justify-center text-white">\n                      C\n                    </div>\n                  ':""}\n                  <div class="p-2 rounded-lg ${"user"===e.role?"bg-blue-500 text-white":"bg-gray-200"}">\n                    ${e.content}\n                  </div>\n                </div>\n              `)).join("")}\n            </div>\n            <div class="p-4 border-t">\n              <div class="flex space-x-2">\n                <input\n                  type="text"\n                  placeholder="Message..."\n                  value="${s}"\n                  class="flex-grow p-2 border rounded"\n                  ${d?"disabled":""}\n                />\n                <button class="p-2 bg-blue-500 text-white rounded" ${d?"disabled":""}>\n                  ${d?"Sending...":"Send"}\n                </button>\n              </div>\n            </div>\n          </div>\n        `:""}\n      `,document.getElementById("toggle-chat").addEventListener("click",a),r&&(document.querySelector("input").addEventListener("keypress",c),document.querySelector("button:last-child").addEventListener("click",u))}function a(){r=!r,l()}function c(e){"Enter"===e.key&&u()}async function u(){const e=document.querySelector("input");if(e.value.trim()&&!d){d=!0,s=e.value;const o=[...i,{role:"user",content:s}];i=o,s="",l();try{const e=await fetch(`${t}/api/chatbot-preview`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:o,chatbotId:n})});if(!e.ok)throw new Error("Failed to get response from chatbot");const r=await e.json();if(!r.response)throw new Error("Empty response from AI");i=[...o,{role:"assistant",content:r.response}]}catch(e){console.error("Error in chat:",e),i=[...o,{role:"assistant",content:"I'm sorry, I encountered an error. Please try again."}]}finally{d=!1,l()}}}l()}();